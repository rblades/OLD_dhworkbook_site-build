<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Shawn Graham">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Leaflet - HIST3814o Crafting Digital History</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../css/extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Leaflet";
    var mkdocs_page_input_path = "supporting materials/leaflet.txt.md";
    var mkdocs_page_url = "/supporting materials/leaflet.txt/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> HIST3814o Crafting Digital History</a>
        <a href="#skip-nav">Skip navigation menu</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <label hidden for="search-box" aria-hidden="false">Search Documents
    </label>
    <input id="search-box" type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
  <ul class="current">
    
          
            <li class="toctree-l1">
    
    <a class="" href="../..">Home</a>
      </li>
          
            <li class="toctree-l1">
    
    <a class="" href="../../introduction/crafting-digital-history/">Getting Started</a>
      </li>
          
            <li class="toctree-l1">
    
    <span class="caption-text">1. Open Access Research</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../module-1/Open-Access-Research/">Why you should be open</a>
                </li>
                <li class="">
                    
    <a class="" href="../../module-1/Exercises/">Exercises</a>
                </li>
    </ul>
      </li>
          
            <li class="toctree-l1">
    
    <span class="caption-text">2. Finding Data</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../module-2/Finding Data/">How do we find data?</a>
                </li>
                <li class="">
                    
    <a class="" href="../../module-2/Exercises/">Exercises</a>
                </li>
    </ul>
      </li>
          
            <li class="toctree-l1">
    
    <span class="caption-text">3. Fixing Data</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../module-3/Wrangling Data/">Data is messy</a>
                </li>
                <li class="">
                    
    <a class="" href="../../module-3/Exercises/">Exercises</a>
                </li>
    </ul>
      </li>
          
            <li class="toctree-l1">
    
    <span class="caption-text">4. Analysis</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../module-4/Seeing Patterns/">Seeing Patterns</a>
                </li>
                <li class="">
                    
    <a class="" href="../../module-4/Exercises/">Exercises</a>
                </li>
    </ul>
      </li>
          
            <li class="toctree-l1">
    
    <span class="caption-text">5. Visualization</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../module-5/Humanities Visualization/">Communicating your Findings</a>
                </li>
                <li class="">
                    
    <a class="" href="../../module-5/Exercises/">Exercises</a>
                </li>
    </ul>
      </li>
          
            <li class="toctree-l1">
    
    <a class="" href="../../conclusion/conclusion/">6. Final Thoughts</a>
      </li>
          
            <li class="toctree-l1">
    
    <span class="caption-text">Appendices</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../tei/">Text Encoding Initiative</a>
                </li>
                <li class="">
                    
    <a class="" href="../git-rstudio/">Git in RStudio</a>
                </li>
                <li class="">
                    
    <a class="" href="../regex/">Introduction to Regular Expressions (regex)</a>
                </li>
                <li class="">
                    
    <a class="" href="../regexex/">Regex & the Republic of Texas</a>
                </li>
                <li class="">
                    
    <a class="" href="../open-refine/">Open Refine</a>
                </li>
                <li class="">
                    
    <a class="" href="../ner/">Stanford Named Entity Recognizer</a>
                </li>
                <li class="">
                    
    <a class="" href="../regex-ner/">Going further with regex</a>
                </li>
                <li class="">
                    
    <a class="" href="../quick-intro-r/">Quick intro to R</a>
                </li>
                <li class="">
                    
    <a class="" href="../cyoa.txt/">Choose Your Own Adventure</a>
                </li>
                <li class="">
                    
    <a class="" href="../geoparsing-w-python.txt/">Geoparsing with Python</a>
                </li>
                <li class="">
                    
    <a class="" href="../glitch/">Glitch</a>
                </li>
                <li class="">
                    
    <a class="" href="../gephi.txt/">Social Network Analysis with Gephi</a>
                </li>
                <li class="">
                    
    <a class="" href="../multimode-networks.txt/">Multimode Networks</a>
                </li>
                <li class="">
                    
    <a class="" href="../graphing-the-net.txt/">Graphing the Net</a>
                </li>
                <li class="">
                    
    <a class="" href="../topicmodel-r-dhbox/">Topic Modeling, DH Box</a>
                </li>
                <li class="">
                    
    <a class="" href="../topicmodel-r-yourmachine/">Topic Modeling, Local</a>
                </li>
                <li class="">
                    
    <a class="" href="../netviz/">Network visualization with igraph</a>
                </li>
                <li class="">
                    
    <a class="" href="../inkscape/">Inkscape</a>
                </li>
                <li class="">
                    
    <a class="" href="../gh-pages/">GitHub Pages</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Leaflet</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#making-a-map-website-with-leafletjs">Making a map website with Leaflet.js</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#setup">Setup</a></li>
        
            <li><a class="toctree-l4" href="#so-lets-get-started">So let's get started.</a></li>
        
        </ul>
    

    </ul>
                </li>
    </ul>
      </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">HIST3814o Crafting Digital History</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Appendices &raquo;</li>
        
      
    
    <li>Leaflet</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/shawngraham/dhworkbook/tree/gh-pages/edit/master/docs/supporting materials/leaflet.txt.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <a name="skip-nav" aria-label="Anchor link destination for skipping navigation"></a>
          <div role="main">
            <div class="section">
              
                <h1 id="making-a-map-website-with-leafletjs">Making a map website with Leaflet.js</h1>
<p>The <a href="http://leafletjs.com/">leaflet.js</a> library allows you to create quite nice interactive maps in a web-browser, that are also mobile friendly. Here, we'll build a map that uses our georectified map as the base layer (rather than as an image overlay). I won't go into the details, but rather will provide you enough guidance to get going. The documentation for Leaflet is quite extensive, and many other tutorials abound.</p>
<h2 id="setup">Setup</h2>
<ol>
<li>
<p>Create a new GitHub repository for this exercise. </p>
</li>
<li>
<p>Create a new branch called <code>gh-pages</code>. We will be putting our html on the gh-pages branch, so that <code>&lt;your username&gt;/github.io/&lt;repo&gt;map.html</code> can serve us up the webpage when we're done.</p>
</li>
<li>
<p>Leaflet comes with a number of <a href="http://leafletjs.com/examples.html">excellent tutorials</a>. We're going to look at the <a href="http://leafletjs.com/examples/quick-start/">first one</a>. </p>
</li>
<li>
<p>Go to the <a href="http://leafletjs.com/examples/quick-start/">leaflet quick-start tutorial</a> and read through it carefully. In essence, you create a webpage that draws its instructions on how to handle geographic data and how to style that data from the leaflet.js source. That way, the browser knows how to render all the geographic information you're about to give it. </p>
<p>Do you see where leaflet is calling on geographic information? This bit:</p>
<pre><code>L.tileLayer('http://{s}.tiles.mapbox.com/v3/MapID/{z}/{x}/{y}.png', {
    attribution: 'Map data &amp;copy; &lt;a href="http://openstreetmap.org"&gt;OpenStreetMap&lt;/a&gt; contributors, &lt;a href="http://creativecommons.org/licenses/by-sa/2.0/"&gt;CC-BY-SA&lt;/a&gt;, Imagery © &lt;a href="http://mapbox.com"&gt;Mapbox&lt;/a&gt;',
    maxZoom: 18
}).addTo(map);
</code></pre>
<p>is calling on a background layer from the mapbox service. Instead of using mapbox, We can slot the url to the georectified map we made in module 4 in there! That is, swap out the url from the line beginning <code>L.tileLayer</code>. You'd change the copyright notice, etc, too, obviously.</p>
<p>The other bits of code that create callouts, polygons, and so on, are all using decimal degrees to locate the drawn elements on top of that map.</p>
<p>This code:</p>
<pre><code>L.marker([51.5, -0.09]).addTo(map)
            .bindPopup("&lt;b&gt;Hello world!&lt;/b&gt;&lt;br /&gt;I am a popup.").openPopup();
</code></pre>
<p>can be copied and repeated in the document, with new coordinates in decimal degrees for each new point. In the second line, between the quotation marks, you can use regular html to style your text, include pictures, and so on.</p>
</li>
<li>
<p>In a new browser window, open the <a href="http://leafletjs.com/examples/quick-start/example.html">example map for the quickstart guide</a>.</p>
</li>
<li>
<p>Right-click the page and select view source.</p>
</li>
</ol>
<h2 id="so-lets-get-started">So let's get started.</h2>
<ol>
<li>
<p>Create a new html document in your gh-pages branch of your repo.</p>
</li>
<li>
<p>Copy the html from the quickstart map (right-click and select 'view source' on <a href="http://leafletjs.com/examples/quick-start/example.html">Leaflet's quick start example page</a>.</p>
</li>
<li>
<p>Paste the code in your new html document in your gh-pages branch of your repo. Call it 'map.html' and commit your changes.</p>
</li>
<li>
<p>Change the source map to point to a georectified map you made in Module 4. Using the Ottawa Fire Insurance map I used as an example in module 4, I created <a href="http://shawngraham.github.io/exercise/leaflet-ottawa.html">this map</a>. </p>
</li>
<li>
<p>Right click and view my page source to see what I changed up.</p>
<p><strong>NB You could keep the basic mapbox service base map, and render the Ottawa Fire Insurance map as an overlay [reference documentation]http://leafletjs.com/reference-1.0.3.html#imageoverlay). Or you could do a series of overlays, showing the change in the city over time. (My favourite example of a leaflet-powered historical map visualization is the <a href="http://revolt.axismaps.com/">Slave Revolt in Jamaica project</a> by Vincent Brown). But you don't necessarily have to do this.</strong></p>
</li>
<li>
<p>Add a series of markers with historical information by duplicating and then changing up the <code>L.marker</code> settings to your own data. Commit your changes!</p>
<p>This all just makes the map. The rest of the webpage would have to be styled as you would normally for a webpage. That is, you'd probably want to add an explanation about what the map shows, how it was created, and how the user ought to interact with it, links to your source data, and so on. The easiest place to add all that kind of information would be between these two tags in the page source:</p>
<pre><code>&lt;/script&gt;
&lt;/body&gt;
</code></pre>
</li>
</ol>
<h3 id="going-further">Going further</h3>
<p>Let's say you have a whole bunch of information that you want to represent on the map. Perhaps it's in a well organized CSV file, with a latitude and a longitude column in decimal degrees. Adding points one at a time to the map as described above would take ages. Instead, let's convert that CSV to geojson, and then use <a href="https://github.com/bmcbride/bootleaf">bootleaf</a> to make a map.</p>
<p>Bootleaf is a template that uses a common html template package, '<a href="http://getbootstrap.com/">Bootstrap</a>' as a wrapper for a leaflet powered map that draws its points of interest from a geojson file. To get this up and running, do the following steps:</p>
<ol>
<li>
<p>Go to the <a href="https://github.com/bmcbride/bootleaf">GitHub repo for bootleaf</a>.</p>
</li>
<li>
<p>Fork a copy to a new repo (you have to be logged into github.com) by hitting the 'fork' button.</p>
</li>
<li>
<p>In your copy of bootleaf, you now have a gh-pages version of the site. If you go to <code>&lt;yourusername&gt;.github.io/bootleaf</code> you should see an active version of the map.</p>
</li>
<li>
<p>Now, the map is grabbing its data from a series of geojson files. You can use <a href="https://mapbox.github.io/togeojson/">the 'to geo json' service</a> to convert your CSV to geojson. There are other services.</p>
</li>
<li>
<p>Clone your repository in your desktop (by pressing the clone your repo in desktop).</p>
</li>
<li>
<p>Open your desktop client, and make sure you're in the gh-pages branch</p>
</li>
<li>
<p>Using your Windows explorer or Mac finder, put your newly created geojson file in the data folder.</p>
</li>
<li>
<p>Commit and sync your changes.</p>
</li>
<li>
<p>To add your data to the dropdown menu, you need to change the code in the index.html file:</p>
<pre><code>  &lt;li class="dropdown"&gt;
    &lt;a class="dropdown-toggle" id="downloadDrop" href="#" role="button" data-toggle="dropdown"&gt;&lt;i class="fa fa-cloud-download white"&gt;&lt;/i&gt;&amp;nbsp;&amp;nbsp;Download &lt;b class="caret"&gt;&lt;/b&gt;&lt;/a&gt;
    &lt;ul class="dropdown-menu"&gt;
      &lt;li&gt;&lt;a href="data/boroughs.geojson" download="boroughs.geojson" target="_blank" data-toggle="collapse" data-target=".navbar-collapse.in"&gt;&lt;i class="fa fa-download"&gt;&lt;/i&gt;&amp;nbsp;&amp;nbsp;Boroughs&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href="data/subways.geojson" download="subways.geojson" target="_blank" data-toggle="collapse" data-target=".navbar-collapse.in"&gt;&lt;i class="fa fa-download"&gt;&lt;/i&gt;&amp;nbsp;&amp;nbsp;Subway Lines&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href="data/DOITT_THEATER_01_13SEPT2010.geojson" download="theaters.geojson" target="_blank" data-toggle="collapse" data-target=".navbar-collapse.in"&gt;&lt;i class="fa fa-download"&gt;&lt;/i&gt;&amp;nbsp;&amp;nbsp;Theaters&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href="data/DOITT_MUSEUM_01_13SEPT2010.geojson" download="museums.geojson" target="_blank" data-toggle="collapse" data-target=".navbar-collapse.in"&gt;&lt;i class="fa fa-download"&gt;&lt;/i&gt;&amp;nbsp;&amp;nbsp;Museums&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
</code></pre>
<p>And since you probably don't want that other stuff, you could delete it.</p>
</li>
<li>
<p>You could change the 'about' pop-up here:</p>
<pre><code>&lt;div class="tab-pane fade active in" id="about"&gt;
  &lt;p&gt;A simple, responsive template for building web mapping applications with &lt;a href="http://getbootstrap.com/"&gt;Bootstrap 3&lt;/a&gt;, &lt;a href="http://leafletjs.com/" target="_blank"&gt;Leaflet&lt;/a&gt;, and &lt;a href="http://twitter.github.io/typeahead.js/" target="_blank"&gt;typeahead.js&lt;/a&gt;. Open source, MIT licensed, and available on &lt;a href="https://github.com/bmcbride/bootleaf" target="_blank"&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
  &lt;div class="panel panel-primary"&gt;
    &lt;div class="panel-heading"&gt;Features&lt;/div&gt;
    &lt;ul class="list-group"&gt;
      &lt;li class="list-group-item"&gt;Fullscreen mobile-friendly map template with responsive navbar and modal placeholders&lt;/li&gt;
      &lt;li class="list-group-item"&gt;jQuery loading of external GeoJSON files&lt;/li&gt;
      &lt;li class="list-group-item"&gt;Logical multiple layer marker clustering via the &lt;a href="https://github.com/Leaflet/Leaflet.markercluster" target="_blank"&gt;leaflet marker cluster plugin&lt;/a&gt;&lt;/li&gt;
      &lt;li class="list-group-item"&gt;Elegant client-side multi-layer feature search with autocomplete using &lt;a href="http://twitter.github.io/typeahead.js/" target="_blank"&gt;typeahead.js&lt;/a&gt;&lt;/li&gt;
      &lt;li class="list-group-item"&gt;Responsive sidebar feature list synced with map bounds, which includes sorting and filtering via &lt;a href="http://listjs.com/" target="_blank"&gt;list.js&lt;/a&gt;&lt;/li&gt;
      &lt;li class="list-group-item"&gt;Marker icons included in grouped layer control via the &lt;a href="https://github.com/ismyrnow/Leaflet.groupedlayercontrol" target="_blank"&gt;grouped layer control plugin&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/div&gt;
</code></pre>
</li>
<li>
<p>And you have to remove this:</p>
<pre><code>    &lt;!-- Remove this maptiks analytics code from your BootLeaf implementation --&gt;
    &lt;script src="//cdn.maptiks.com/maptiks-leaflet.min.js"&gt;&lt;/script&gt;
    &lt;script&gt;maptiks.trackcode='c7ca251e-9c17-47ef-ac33-e0fb24e05976';&lt;/script&gt;
    &lt;!-- End maptiks analytics code --&gt;
</code></pre>
<p>Now the really hard part: putting your own base maps in. </p>
</li>
<li>
<p>To insert your own base map, you have to find, and modify, a file called app.js. You should be able to find it by following this path: bootleaf/assets/js/app.js</p>
</li>
<li>
<p>You need to change these lines to point to your maps</p>
<pre><code>/* Basemap Layers */
var mapquestOSM = L.tileLayer("http://{s}.mqcdn.com/tiles/1.0.0/osm/{z}/{x}/{y}.png", {
  maxZoom: 19,
  subdomains: ["otile1", "otile2", "otile3", "otile4"],
  attribution: 'Tiles courtesy of &lt;a href="http://www.mapquest.com/" target="_blank"&gt;MapQuest&lt;/a&gt; &lt;img src="http://developer.mapquest.com/content/osm/mq_logo.png"&gt;. Map data (c) &lt;a href="http://www.openstreetmap.org/" target="_blank"&gt;OpenStreetMap&lt;/a&gt; contributors, CC-BY-SA.'
});
var mapquestOAM = L.tileLayer("http://{s}.mqcdn.com/tiles/1.0.0/sat/{z}/{x}/{y}.jpg", {
  maxZoom: 18,
  subdomains: ["oatile1", "oatile2", "oatile3", "oatile4"],
  attribution: 'Tiles courtesy of &lt;a href="http://www.mapquest.com/" target="_blank"&gt;MapQuest&lt;/a&gt;. Portions Courtesy NASA/JPL-Caltech and U.S. Depart. of Agriculture, Farm Service Agency'
});
var mapquestHYB = L.layerGroup([L.tileLayer("http://{s}.mqcdn.com/tiles/1.0.0/sat/{z}/{x}/{y}.jpg", {
  maxZoom: 18,
  subdomains: ["oatile1", "oatile2", "oatile3", "oatile4"]
}), L.tileLayer("http://{s}.mqcdn.com/tiles/1.0.0/hyb/{z}/{x}/{y}.png", {
  maxZoom: 19,
  subdomains: ["oatile1", "oatile2", "oatile3", "oatile4"],
  attribution: 'Labels courtesy of &lt;a href="http://www.mapquest.com/" target="_blank"&gt;MapQuest&lt;/a&gt; &lt;img src="http://developer.mapquest.com/content/osm/mq_logo.png"&gt;. Map data (c) &lt;a href="http://www.openstreetmap.org/" target="_blank"&gt;OpenStreetMap&lt;/a&gt; contributors, CC-BY-SA. Portions Courtesy NASA/JPL-Caltech and U.S. Depart. of Agriculture, Farm Service Agency'
})]);
</code></pre>
<p>...and then you'd have to go through the rest of that file and change up the .geojson pointers to point to your own data.</p>
</li>
<li>
<p>Visit GitHub for a <a href="https://github.com/shawngraham/daea">template for mapping with leaflet</a>, drawing all of your point data and ancillary information from a CSV file. Study the index.html file carefully to identify which lines you'd modify to change the base map, and to identify how elements in the CSV are being rendered on the screen. <a href="https://xtina-r.github.io/daea/">Visit this example that a former student made</a>.</p>
</li>
</ol>
<p><strong>Further reading:</strong> Arian Katsimbras on making beautiful maps with <a href="https://medium.com/@ArianKatsimbras/tilemill-c886a3ccba6a">Tilemill</a>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../gh-pages/" class="btn btn-neutral" title="GitHub Pages"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

The Crafting Digital History site is built with <a href="http://www.mkdocs.org">MkDocs</a> using a theme provided by <a href="https://readthedocs.org">Read the Docs</a>. All documents are available on <a href="https://github.com/shawngraham/dhworkbook/tree/gh-pages"> GitHub</a>. I thank Reclaim Hosting for their help, support, and example in getting this site up and running.
</footer>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.1.0/jquery.fitvids.min.js"></script>
<script>
  $(document).ready(function(){
    // Target your .container, .wrapper, .post, etc.
    $(".section").fitVids();
  });
</script>
    
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/shawngraham/dhworkbook/tree/gh-pages" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../gh-pages/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>
    <script src="../../js/theme.js"></script>
      <script src="../../js/tota11y.min.js"></script>

</body>
</html>
